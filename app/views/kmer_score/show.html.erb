<%= javascript_pack_tag 'haplotype_plot' %>

<style>

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

</style>

<h1>
<%= @species %> chromosome <%= @chr %>
</h1>	

<div id="haplotype_plot"></div>

<script type="text/javascript">
	window.addEventListener('load', function(){

		var rsc = new RegionScoreContainer({
			"species"    : "wheat", 
			"analysis"   : "kmerGWAS",
			"reference"  : "arinalrfor",
			"samples"    :["flame_kmerGWAS"],
			"chromosome" : "<%= @chr %>" 
		});

		var hap_plot = new HaplotypePlot({
			'current_dataset': '<%= @hap_set.name %>',
			'datasets': {
				<% @hap_sets.each do |h_s| %>
					'<%= h_s.name %>': new HaplotypeRegionSet({
						'name': '<%= h_s.name %>',
						'description': '<%= h_s.description %>',
						'csv_file': '<%= @csv_paths[h_s.name] %>'
					}),
				<% end %>
			},
			'assemblies': [<%= raw(@assemblies) %>],
			'displayed_assemblies':['SY Mattis','CDC Stanley'],
			'current_coord_mapping': "2mbp",
			'coord_mapping':{
				"2mbp" : new AssemblyRegionSet({
					'name' : '2mbp',
					'description' : "2Mbp mapping windows",
					'csv_file' :  "/<%= @species %>/coordinates/<%= @chr%>/window/2000000.csv"
				}) 
			},
			'width':1000, 
			'region_scores_container': rsc,
			'display_samples': ["flame_kmerGWAS"],
			'display_score'  : "total_kmers" ,
			'toggle_assemblies': true
		});

		// hap_plot.region_scores = rsc;
		// hap_plot.display_sample("flame_kmerGWAS", true);
		// hap_plot.display_score = "total_kmers";
		
		//rsc.sample("flame_kmerGWAS");
	});

</script>